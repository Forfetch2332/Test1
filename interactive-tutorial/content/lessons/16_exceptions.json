{
  "title": "Исключения: try/except/else/finally, raise",
  "summary": "Понимание механизма исключений в Python: перехват ошибок с помощью try/except, уточнение логики через else и finally, и явная генерация ошибок с помощью raise.",
  "text": [
    "Исключения — это механизм обработки ошибок и необычных ситуаций во время выполнения программы. Когда в коде возникает непредвиденная ситуация (деление на ноль, неверный ввод, потерянный файл), Python генерирует исключение. Если оно не перехвачено, программа прерывается и выводит трассировку (traceback).",
    "Блок try/except позволяет безопасно обрабатывать такие ситуации: код, который может вызвать ошибку, помещают в блок try, а действия по обработке ошибки — в блок except. Это похоже на запасной план: если основной сценарий сломался, выполняется план Б.",
    "Форма try/except бывает разной. Самый простой вариант:\ntry:\n    result = 10 / x\nexcept ZeroDivisionError:\n    print('Деление на ноль недопустимо').\nЗдесь мы перехватываем конкретный тип исключения ZeroDivisionError и обрабатываем его понятным сообщением.",
    "Можно перехватывать несколько типов исключений в одной конструкции через кортеж или определить несколько отдельных except-блоков для разной логики обработки. Например, except (ValueError, TypeError): обработает и ValueError, и TypeError.",
    "Если нужно получить информацию об исключении (сообщение, тип), можно привязать его к переменной: except Exception as e:. Это удобно для логирования или вывода подробностей ошибки.",
    "Блок else выполняется только если в try не было исключений. Он полезен для кода, который должен выполняться при успешном завершении попытки, отдельно от блока обработки ошибок. Порядок: try → except → else (если нет ошибок) → finally.",
    "Блок finally выполняется всегда — независимо от того, возникло исключение или нет. Его используют для действий, которые обязательно нужно выполнить: закрыть файл, освободить ресурсы, сохранить состояние. Это гарантированный «уборщик» в конце.",
    "Иногда полезно намеренно сгенерировать исключение с помощью raise. Это делают, чтобы сигнализировать о некорректном состоянии или проверке пред-условий. Пример: if age < 0: raise ValueError('Возраст не может быть отрицательным'). Таким образом функция сообщает вызывающему коду, что с входными данными что‑то не так.",
    "Художественный образ: представь программу как корабль в море. Исключения — это шторма и рифы. Блок try — это навигация в опасной зоне, except — спасательная шлюпка, else — безопасный заход в порт, а finally — обязательно закрыть люк и проверить трюм перед отпуском команды.",
    "Правильное использование исключений делает код надёжнее и понятнее. Вместо того чтобы позволять программе упасть, лучше аккуратно перехватить и обработать ожидаемые ошибки, а неожиданные — логировать и поднять дальше."
  ],
  "example": "def safe_divide(a, b):\n    try:\n        result = a / b\n    except ZeroDivisionError as e:\n        print('Ошибка: деление на ноль.')\n        return None\n    except TypeError as e:\n        print('Ошибка: неверный тип аргументов.')\n        return None\n    else:\n        print('Деление выполнено успешно.')\n        return result\n    finally:\n        print('Операция деления завершена.')\n\nprint(safe_divide(10, 2))\nprint(safe_divide(5, 0))\nprint(safe_divide(5, 'a'))\n\n# Пример raise\n\ndef set_age(age):\n    if not isinstance(age, int):\n        raise TypeError('Возраст должен быть целым числом')\n    if age < 0:\n        raise ValueError('Возраст не может быть отрицательным')\n    return age\n\ntry:\n    print(set_age(-5))\nexcept Exception as e:\n    print('При установке возраста возникла ошибка:', e)",
  "notes": [
    {
      "hint": "Перехватывай только те типы исключений, которые ожидаешь и умеешь обрабатывать. Ловить 'Exception' повсеместно — плохая практика."
    },
    {
      "hint": "Используй конкретные классы исключений (ZeroDivisionError, FileNotFoundError, ValueError) — это делает обработку точной и безопасной."
    },
    {
      "hint": "Блок finally полезен для гарантированного освобождения ресурсов: закрыть файл, сетевое соединение или базу данных."
    },
    {
      "hint": "Блок else выполняется только если в try не было исключений. Помести туда код, зависящий от успешного выполнения try."
    },
    {
      "hint": "При использовании raise указывай информативное сообщение: это ускорит отладку и поможет пользователю понять причину ошибки."
    },
    {
      "hint": "Не используй исключения для обычного управления потоком программы. Они предназначены для ошибок и исключительных ситуаций, а не для обычной логики."
    },
    {
      "hint": "Для отладки полезно логировать исключения с трассировкой (traceback), особенно в серверных приложениях."
    },
    {
      "hint": "Можно создавать свои классы исключений, наследуя Exception, чтобы отличать специфические ошибки внутри библиотеки или приложения."
    }
  ]
}
